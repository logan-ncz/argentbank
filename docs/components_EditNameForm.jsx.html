<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/EditNameForm.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/EditNameForm.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState } from "react";

import { useDispatch, useSelector } from "react-redux";

import { setFirstName, setLastName } from "../redux/reducers";

import { selectUserName } from "../redux/selectors";


/**Component used to render the editNameForm and manage the update of the user name
 * @component
 * 
 * @param {*} props 
 * @returns {}
 */
function EditNameForm(props) {
    const token = useSelector((state) => state.user.token);
    const userFirstName = useSelector(selectUserName('firstName'));
    const userLastName = useSelector(selectUserName('lastName'));
    const dispatch = useDispatch();

    const [ userInputs, setUserInputs ] = useState({
        firstName: '',
        lastName: '',
    });

    const handleInputChange = (event) => {
        const inputName = event.target.id;

        setUserInputs({
            ...userInputs,
            [inputName]: event.target.value,
        });
    };
    
    const handleEditFormSubmit = (event) => {
        event.preventDefault();

        updateFunction()

        props.toggleEditionMode()
    };

    const updateFunction = () => {
        const url = "http://localhost:3001/api/v1/user/profile";

        const userInfosPayload = {
            firstName: userInputs.firstName,
            lastName: userInputs.lastName,
        }

        const requestOptions = {
            method: "PUT",
            body: JSON.stringify(userInfosPayload),
            headers: {
                'Content-Type' : 'application/json',
                Authorization: `Bearer ${token}`,
            },
        };
    
        // Send PUT request:
        fetch(url, requestOptions)
        .then((response) => response.json())
        .then((json) => {
            console.log("/user/profile response to PUT:", json);
            dispatch(setFirstName(userInputs.firstName))
            dispatch(setLastName(userInputs.lastName))
        })
        .catch((error) => {
            console.error(
            `An error has occured while posting to /user/profile: ${error}`
            );
        });
    };
    
    return (
        &lt;form onSubmit={handleEditFormSubmit} className="editNameForm">
            &lt;div>
                &lt;input
                    type="text"
                    id="firstName"
                    placeholder={userFirstName}
                    onChange={handleInputChange}
                />

                &lt;input
                    type="text"
                    id="lastName"
                    placeholder={userLastName}
                    onChange={handleInputChange}
                />
            &lt;/div>
            
            &lt;div>
                &lt;button className="editNameForm-saveBtn" type="submit">Save&lt;/button>

                &lt;button className="editNameForm-cancelBtn" type="button" onClick={props.toggleEditionMode}>Cancel&lt;/button>
            &lt;/div>
        &lt;/form>
    )
}

export default EditNameForm</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AccountCard.html">AccountCard</a></li><li><a href="EditNameForm.html">EditNameForm</a></li><li><a href="Footer.html">Footer</a></li><li><a href="LoginForm.html">LoginForm</a></li><li><a href="Nav.html">Nav</a></li></ul><h3>Global</h3><ul><li><a href="global.html#GetUserProfile">GetUserProfile</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue May 03 2022 15:05:54 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
